<%# require 'money' %>
<h1> Driver Details </h1>
<h2><%= @driver.name %></h2>

<% i = 1.0 %>
<% sum = 0 %>
<% earnings = 0 %>
<% @driver.trips.each do |trip| %>
  <% sum += trip.rating %>
  <% earnings += trip.cost %>
  <% i += 1%>
<% end %>

<ul>
  <li>
    Total Earnings: $<%= sprintf('%.2f', (earnings + (0.15 * earnings)) / 100.0 )%>
  </li>
  <li>
    Average Rating: <%= sprintf('%.2f', sum/(i - 1) )%>
  </li>
  <li>
    Trips (Click on trip name for details):
  </li>
  <ul>
    <% i = 1 %>
    <% @driver.trips.each do |trip| %>
    <li>
      <%=link_to "Trip #{i}:", trip_path(trip.id) %>
      Date: <%= trip.date %>,
      Rating: <%= trip.rating %>,
      Cost: $<%= (trip.cost) / 100.0 %>,
      <% i += 1%>
    </li>
    <% end %>
  </ul>
  <li>
    <%= link_to "Edit", edit_driver_path(@driver.id) %>
  </li>
  <li>
    <%= link_to "Delete", driver_path(@driver.id), method: :delete, data: {:confirm => "Are you sure you want to delete this driver?"} %>
  </li>

</ul>
